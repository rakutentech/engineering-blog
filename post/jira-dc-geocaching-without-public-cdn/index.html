<html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=icon href=/images/favicon.svg><link rel=stylesheet href=/scss/main.min.b3ed7c7076a200b40314c0134930ccd8fa88a21a0b3fcdcf5c1bd1ae2ff9de60.css><link rel=stylesheet href=/css/prism.css><link href="https://fonts.googleapis.com/css?family=Merriweather&display=swap" rel=stylesheet><title>Jira DC Geocaching Without Public CDN | Rakuten Engineering Blog</title><meta name=description content="Atlassian recently introduced Content Delivery Networks (CDN) support to their products, namely Jira from version 8.3 onwards. This support includes common CDNs like AWS CloudFront, Cloudflare, Akamai, and others1. However, there is no clear documentation on how to use the feature using self-hosted cache servers instead of a publicly available CDN. In this article, we go through the procedure of implementing Jira cache servers in other geographic locations and enabling them in Jira using the CDN feature."><meta property="og:title" content="Jira DC Geocaching Without Public CDN | Rakuten Engineering Blog"><meta property="og:site_name" content="Rakuten Engineering Blog"><meta property="og:description" content="Atlassian recently introduced Content Delivery Networks (CDN) support to their products, namely Jira from version 8.3 onwards. This support includes common CDNs like AWS CloudFront, Cloudflare, Akamai, and others1. However, there is no clear documentation on how to use the feature using self-hosted cache servers instead of a publicly available CDN. In this article, we go through the procedure of implementing Jira cache servers in other geographic locations and enabling them in Jira using the CDN feature."><meta property="og:url" content="https://engineering.rakuten.today/post/jira-dc-geocaching-without-public-cdn/"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://engineering.rakuten.today/post/jira-dc-geocaching-without-public-cdn/images/cover.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Jira DC Geocaching Without Public CDN | Rakuten Engineering Blog"><link rel=canonical href=https://engineering.rakuten.today/post/jira-dc-geocaching-without-public-cdn/><meta name=twitter:description content="Atlassian recently introduced Content Delivery Networks (CDN) support to their products, namely Jira from version 8.3 onwards. This support includes common CDNs like AWS CloudFront, Cloudflare, Akamai, and others1. However, there is no clear documentation on how to use the feature using self-hosted cache servers instead of a publicly available CDN. In this article, we go through the procedure of implementing Jira cache servers in other geographic locations and enabling them in Jira using the CDN feature."><meta name=twitter:image content="https://engineering.rakuten.today/post/jira-dc-geocaching-without-public-cdn/images/cover.jpg"><meta property="article:published_time" content="2021-10-20T11:18:57+09:00"><meta property="article:updated_time" content="2021-10-20T11:18:57+09:00"><script type=application/javascript>var dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,GA_SESSION_STORAGE_KEY,doNotTrack=dnt=="1"||dnt=="yes";doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,window.sessionStorage&&(GA_SESSION_STORAGE_KEY="ga:clientId",ga("create","G-Z6FNGN7J13",{storage:"none",clientId:sessionStorage.getItem(GA_SESSION_STORAGE_KEY)}),ga(function(e){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,e.get("clientId"))})),ga("set","anonymizeIp",!0),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=line-numbers><script src=/js/initColors.js></script><div class=layout-styled><section class=section><div class=nav-container><a class=logo-link href=/><div id=logo-desktop><svg height="32" viewBox="0 0 333.4 41.1" xmlns="http://www.w3.org/2000/svg"><path class="change-fill" d="M111.3 34.5H27.6l6.7 6.6zM35.4 7.5v1c-1.6-1-2.9-1.6-4.9-1.6-5.9.0-10.3 5.3-10.3 11.9.0 6.6 4.5 11.9 10.3 11.9 1.9.0 3.3-.6 4.9-1.6v1h5.2V7.5h-5.2zm-4.9 17.8c-2.9.0-5-2.8-5-6.4.0-3.6 2.1-6.4 5-6.4s4.9 2.8 4.9 6.4c.1 3.6-2 6.4-4.9 6.4zM76.6 7.5v13.3c0 2.5-1.7 4.6-4.2 4.6s-4.2-2.1-4.2-4.6V7.5h-5.1v13.3c0 5.5 3.7 9.9 9.2 9.9 2.5.0 4.4-1.4 4.4-1.4v.8h5.2V7.5h-5.3zm48 22.7V16.9c0-2.5 1.7-4.6 4.2-4.6s4.2 2.1 4.2 4.6v13.3h5.1V16.9c0-5.5-3.7-9.9-9.2-9.9-2.5.0-4.4 1.4-4.4 1.4v-.9h-5.1v22.7h5.2z"/><path class="change-fill" d="M5.4 30.2v-8.8h3.8l6.6 8.8h6.7l-8-10.6c2.5-1.8 4.1-4.7 4.1-8 0-5.4-4.4-9.8-9.8-9.8H0v28.3h5.4zm0-22.9h3.5c2.4.0 4.4 2 4.4 4.4s-2 4.4-4.4 4.4H5.4V7.3zM95.7 24.9c-.5.3-1 .6-1.7.6-.8.0-2.4-.6-2.4-2.8V13H96V7.5h-4.4V1.9h-5.1v5.7h-2.7V13h2.7v9.8c0 5.1 3.8 8.1 7.7 8.1 1.4.0 3.4-.5 5-1.4l-3.5-4.6zM53.3 18.2l8.9-10.7H55l-6.2 7.9V0h-5.3v30.2h5.3v-9.3l7.6 9.3h7.2z"/><path class="change-fill" d="M107.6 7c-6 0-10.2 5.2-10.2 11.9.0 7 5.4 11.9 10.7 11.9 2.7.0 6.2-.9 9.1-5.1l-4.5-2.6c-3.5 5.2-9.4 2.6-10.1-2.6h14.8c1.3-8.2-4-13.5-9.8-13.5zm4.5 8.9h-9.3c1.1-5.3 8.3-5.6 9.3.0z"/><path class="change-fill" d="M155.5 3.3c7 0 12.1 5.6 12.1 13.4.0 8-5 13.5-12.1 13.5h-8.8V3.3h8.8zm-3.6 22.1h3.7c4 0 6.7-3.5 6.7-8.7.0-5.1-2.7-8.7-6.7-8.7h-3.7v17.4zM188.6 25.9c-2.4 3.3-5.2 4.8-8.8 4.8-6.2.0-10.6-4.7-10.6-11.3.0-6.4 4.3-11.4 10-11.4 5.5.0 10 5 10 11.3.0.5.0 1-.1 1.6H175c.3 3 2.3 4.9 5.1 4.9 1.5.0 2.9-.9 4.2-2.5l4.3 2.6zm-5.3-9.3c-.5-2.6-1.9-3.9-4.1-3.9-2.1.0-3.7 1.4-4.2 3.9h8.3zm18.2 13.6h-5.7l-7.2-21.6h5.9l4.2 14.4 4.2-14.4h5.9l-7.3 21.6zm26.1-4.3c-2.4 3.3-5.2 4.8-8.8 4.8-6.2.0-10.6-4.7-10.6-11.3.0-6.4 4.3-11.4 10-11.4 5.5.0 10 5 10 11.3.0.5.0 1-.1 1.6H214c.3 3 2.3 4.9 5.1 4.9 1.5.0 2.9-.9 4.2-2.5l4.3 2.6zm-5.3-9.3c-.5-2.6-2-3.9-4.1-3.9s-3.7 1.4-4.2 3.9h8.3zM230.2 30.2V1.5h5.5v28.7h-5.5zm28-10.8c0 6.6-4.2 11.3-10.1 11.3S238 25.9 238 19.4s4.2-11.3 10.1-11.3 10.1 4.8 10.1 11.3zm-15.1.1c0 3.5 2.1 6.2 5 6.2s5-2.6 5-6.2-2.1-6.2-5-6.2c-2.9-.1-5 2.6-5 6.2zm22.4-8.9c1.3-1.6 2.9-2.5 5-2.5 5.5.0 10.1 5.1 10.1 11.3.0 6.3-4.4 11.3-9.9 11.3-2 0-3.7-.8-5.2-2.2v7.1h-5.1v-27h4.4l.7 2zm0 8.8c0 3.8 2.1 6.5 5 6.5 2.8.0 5-2.9 5-6.5.0-3.7-2.2-6.5-5-6.5-2.9.0-5 2.8-5 6.5zm36 6.5c-2.4 3.3-5.2 4.8-8.8 4.8-6.2.0-10.6-4.7-10.6-11.3.0-6.4 4.3-11.4 10-11.4 5.5.0 10 5 10 11.3.0.5.0 1-.1 1.6h-14.1c.3 3 2.3 4.9 5.1 4.9 1.5.0 2.9-.9 4.2-2.5l4.3 2.6zm-5.2-9.3c-.5-2.6-2-3.9-4.1-3.9s-3.7 1.4-4.2 3.9h8.3zm12.4-6c1.4-1.6 3.6-2.5 6.3-2.5v4.8c-2.4.2-3.8.9-4.8 2.4-.6.9-.9 2-.9 3.1v11.8h-5.1V8.7h4.1l.4 1.9zm20.5 4.5c-1.5-1.5-2.8-2.2-4.3-2.2-1.4.0-2.4.7-2.4 1.8.0 1 .6 1.6 2.2 2 2.6.7 4.1 1.3 5.3 1.9 2.3 1.3 3.4 3.1 3.4 5.4.0 4-3.4 6.7-8.5 6.7-3.9.0-6.7-1.4-8.8-4.3l3.5-3.3c1.3 1.8 3.2 2.8 5.4 2.8 1.9.0 2.9-.7 2.9-1.9.0-1.1-.8-1.7-4-2.8-2.8-1-3.6-1.3-4.6-2-1.6-1.1-2.3-2.6-2.3-4.6.0-3.8 3.4-6.6 7.9-6.6 2.9.0 5.3 1 7.7 3.1l-3.4 4z"/></svg></div><div id=logo-mobile class=hidden><svg height="52" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 187 76"><path d="M111.3 34.5H27.6l6.7 6.6 77-6.6zm-75.9-27v1a8.4 8.4.0 00-4.9-1.6c-5.9.0-10.3 5.3-10.3 11.9.0 6.6 4.5 11.9 10.3 11.9 1.9.0 3.3-.6 4.9-1.6v1h5.2V7.5h-5.2zm-4.9 17.8c-2.9.0-5-2.8-5-6.4.0-3.6 2.1-6.4 5-6.4s4.9 2.8 4.9 6.4c.1 3.6-2 6.4-4.9 6.4zM76.6 7.5v13.3c0 2.5-1.7 4.6-4.2 4.6s-4.2-2.1-4.2-4.6V7.5h-5.1v13.3c0 5.5 3.7 9.9 9.2 9.9 2.5.0 4.4-1.4 4.4-1.4v.8h5.2V7.5h-5.3zm48 22.7V16.9c0-2.5 1.7-4.6 4.2-4.6s4.2 2.1 4.2 4.6v13.3h5.1V16.9c0-5.5-3.7-9.9-9.2-9.9-2.5.0-4.4 1.4-4.4 1.4v-.9h-5.1v22.7h5.2z" class="change-fill"/><path d="M5.4 30.2v-8.8h3.8l6.6 8.8h6.7l-8-10.6A9.8 9.8.0 008.8 1.8H0v28.3h5.4v.1zm0-22.9h3.5c2.4.0 4.4 2 4.4 4.4s-2 4.4-4.4 4.4H5.4V7.3zm90.3 17.6c-.5.3-1 .6-1.7.6-.8.0-2.4-.6-2.4-2.8V13H96V7.5h-4.4V1.9h-5.1v5.7h-2.7V13h2.7v9.8c0 5.1 3.8 8.1 7.7 8.1 1.4.0 3.4-.5 5-1.4l-3.5-4.6zm-42.4-6.7 8.9-10.7H55l-6.2 7.9V0h-5.3v30.2h5.3v-9.3l7.6 9.3h7.2l-10.3-12z" class="change-fill"/><path d="M107.6 7c-6 0-10.2 5.2-10.2 11.9.0 7 5.4 11.9 10.7 11.9 2.7.0 6.2-.9 9.1-5.1l-4.5-2.6c-3.5 5.2-9.4 2.6-10.1-2.6h14.8c1.3-8.2-4-13.5-9.8-13.5zm4.5 8.9h-9.3c1.1-5.3 8.3-5.6 9.3.0zM8.8 43.5c7 0 12 5.6 12 13.4.0 8-5 13.5-12 13.5H0v-27h8.8zm-3.6 22h3.7c4 0 6.7-3.4 6.7-8.6.0-5.1-2.7-8.7-6.7-8.7H5.2v17.4zm36.7.6c-2.4 3.3-5.2 4.8-8.8 4.8-6.2.0-10.6-4.7-10.6-11.3.0-6.4 4.3-11.4 10-11.4 5.5.0 10 5 10 11.3l-.1 1.6H28.3c.3 3 2.3 4.9 5 4.9 1.6.0 3-1 4.3-2.5l4.3 2.6zm-5.3-9.3c-.5-2.6-2-4-4.1-4s-3.7 1.5-4.2 4h8.3zm18.2 13.6H49l-7.2-21.6h5.9L52 63.2l4.2-14.4H62l-7.3 21.6zm26-4.3c-2.3 3.3-5.1 4.8-8.7 4.8-6.2.0-10.6-4.7-10.6-11.3.0-6.4 4.3-11.4 10-11.4 5.5.0 10 5 10 11.3l-.1 1.6H67.3c.3 3 2.3 4.9 5 4.9 1.6.0 3-1 4.3-2.5l4.3 2.6zm-5.2-9.3c-.5-2.6-2-4-4.1-4s-3.7 1.5-4.2 4h8.3zm7.9 13.6V41.7H89v28.7h-5.5zm28-10.8c0 6.6-4.2 11.3-10.1 11.3-6 0-10.1-4.8-10.1-11.3s4.2-11.3 10-11.3c6 0 10.2 4.8 10.2 11.3zm-15.1.0c0 3.6 2 6.3 5 6.3s5-2.6 5-6.2-2.1-6.2-5-6.2c-3-.1-5 2.6-5 6.2zm22.4-8.8a6.2 6.2.0 015-2.5c5.5.0 10 5 10 11.3s-4.3 11.3-9.8 11.3c-2 0-3.7-.8-5.2-2.2v7h-5.1v-27h4.4l.7 2zm0 8.8c0 3.8 2 6.5 5 6.5 2.8.0 5-3 5-6.5.0-3.7-2.2-6.5-5-6.5-3 0-5 2.8-5 6.5zm36 6.5c-2.4 3.3-5.2 4.8-8.8 4.8-6.2.0-10.6-4.7-10.6-11.3.0-6.4 4.3-11.4 10-11.4 5.5.0 10 5 10 11.3l-.1 1.6h-14.1c.3 3 2.3 4.9 5 4.9 1.6.0 3-1 4.3-2.5l4.3 2.6zm-5.2-9.3c-.5-2.6-2-4-4.1-4s-3.7 1.5-4.2 4h8.3zm12.4-6a8.1 8.1.0 016.3-2.5V53c-2.4.2-3.8.9-4.8 2.4-.6.9-1 2-1 3v11.9h-5V48.9h4l.5 1.9zm20.5 4.5c-1.5-1.5-2.8-2.2-4.3-2.2-1.4.0-2.4.7-2.4 1.8.0 1 .6 1.6 2.2 2 2.6.7 4 1.3 5.3 1.9 2.3 1.3 3.4 3 3.4 5.4.0 4-3.4 6.7-8.5 6.7a10 10 0 01-8.8-4.3l3.5-3.3a6.5 6.5.0 005.4 2.8c1.9.0 2.9-.7 2.9-2 0-1-.8-1.6-4-2.7-2.8-1-3.6-1.3-4.6-2a5.2 5.2.0 01-2.3-4.6c0-3.8 3.4-6.6 7.9-6.6 2.9.0 5.3 1 7.7 3l-3.4 4z" class="change-fill"/></svg></div><span class=header-hidden>Navigate back to the homepage</span></a><div class=nav-controls><button id=copyButton class=icon-wrapper><svg class="icon-image" width="24" height="20" viewBox="0 0 24 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fillRule="evenodd" clipRule="evenodd" d="M2 5C2 3.34328 3.34328 2 5 2h9c1.6567.0 3 1.34328 3 3V9c0 1.6567-1.3433 3-3 3H10C9.44771 12 9 12.4477 9 13S9.44771 14 10 14h4c2.7613.0 5-2.2387 5-5V5c0-2.76128-2.2387-5-5-5H5C2.23872.0.0 2.23872.0 5V9c0 1.4938.656313 2.8361 1.6935 3.7509C2.10768 13.1163 2.73961 13.0767 3.10494 12.6625 3.47028 12.2483 3.43068 11.6164 3.0165 11.2511 2.39169 10.6999 2 9.89621 2 9V5zm5 6c0-1.65672 1.34328-3 3-3h4C14.5523 8 15 7.55228 15 7S14.5523 6 14 6H10C7.23872 6 5 8.23872 5 11v4c0 2.7613 2.23872 5 5 5h9c2.7613.0 5-2.2387 5-5V11C24 9.50621 23.3437 8.16393 22.3065 7.24906 21.8923 6.88372 21.2604 6.92332 20.8951 7.3375 20.5297 7.75168 20.5693 8.38361 20.9835 8.74894 21.6083 9.30007 22 10.1038 22 11v4c0 1.6567-1.3433 3-3 3H10c-1.65672.0-3-1.3433-3-3V11z" fill="#000"/></svg><div id=toolTip class=tool-tip>copied</div><input id=copyText style=opacity:0 type=text class=tool-tip></button>
<button id=themeColorButton class=icon-wrapper><div id=sunRays class=sun-rays></div><div id=moonOrSun class=moon-or-sun></div><div id=moonMask class=moon-mask></div></button></div></div></section><script src=/js/toggleLogos.js></script>
<script src=/js/toggleColors.js></script>
<script src=/js/copyUrl.js></script><section class="section narrow"><section id=articleHero class="section narrow"><div class=article-hero><header class=article-header><h1 class=article-hero-heading>Jira DC Geocaching Without Public CDN</h1><div class=article-hero-subtitle><div class=article-meta><div class=article-coauthors-container><span id=collapsedCoauthors class=article-coauthors-collapsed><div class=article-coauthors-list style=width:30px><div class=article-coauthors-avatar style=left:0><img src=/authors/joao-afonso/joao-afonso-avatar.jpg></div><div class=article-coauthors-avatar style=left:15px><img src=/authors/eric-martin/eric-martin-avatar.jpg></div></div><strong class=article-coauthors-name-container>Joao,
Eric</strong><div class=article-coauthors-icon-container><svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path style="fill:var(--primary)" d="M5.3209 8.86719 8.50026 12.0396 11.6796 8.86719 12.6563 9.84385 8.50026 13.9999 4.34424 9.84385 5.3209 8.86719z"/><path style="fill:var(--primary)" d="M11.6791 8.13281 8.49974 4.96039 5.32039 8.13281 4.34373 7.15615 8.49974 3.00013 12.6558 7.15615 11.6791 8.13281z"/></svg></div></span><ul id=uncollapsedCoauthors class="article-coauthors-list-open hidden"><div id=uncollapsedAction class=article-icon-open-container><svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path style="fill:var(--primary)" d="M11.6796 14 8.50023 10.8276 5.32088 14 4.34422 13.0233 8.50023 8.86732 12.6563 13.0233 11.6796 14z"/><path style="fill:var(--primary)" d="M5.32041 3 8.49977 6.17243 11.6791 3 12.6558 3.97666 8.49977 8.13268 4.34375 3.97666 5.32041 3z"/></svg></div><li class=article-coauthors-list-item-open><a href=/authors/joao-afonso/ class=article-author-link><div class=article-coauthor-avatar-open><img src=/authors/joao-afonso/joao-afonso-avatar.jpg></div><strong class=article-author-name-open>Joao Afonso</strong></a></li><li class=article-coauthors-list-item-open><a href=/authors/eric-martin/ class=article-author-link><div class=article-coauthor-avatar-open><img src=/authors/eric-martin/eric-martin-avatar.jpg></div><strong class=article-author-name-open>Eric Martin</strong></a></li></ul></div><script src=/js/collapseAuthors.js></script>
October 20, 2021
• 7 min read</div><div id=share-buttons><div class=linkedin title="Share this on Linkedin" onclick='window.open("https://www.linkedin.com/shareArticle?mini=true&url=https://engineering.rakuten.today/post/jira-dc-geocaching-without-public-cdn/&title=&summary=&source=")'><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"/></svg></div><div class=twitter title="Share this on Twitter" onclick='window.open("https://twitter.com/intent/tweet?text=https://engineering.rakuten.today/post/jira-dc-geocaching-without-public-cdn/")'><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5T1369.5 1125 1185 1335.5t-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5T285 1033q33 5 61 5 43 0 85-11-112-23-185.5-111.5T172 710v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5T884 653q-8-38-8-74 0-134 94.5-228.5T1199 256q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></div><div class=facebook title="Share this on Facebook" onclick='window.open("http://www.facebook.com/share.php?u=https://engineering.rakuten.today/post/jira-dc-geocaching-without-public-cdn/")'><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"/></svg></div><div class=mail title="Share this through Email" onclick='window.open("mailto:?&body=https://engineering.rakuten.today/post/jira-dc-geocaching-without-public-cdn/")'><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1792 710v794q0 66-47 113t-113 47H160q-66 0-113-47T0 1504V710q44 49 101 87 362 246 497 345 57 42 92.5 65.5t94.5 48 110 24.5h2q51 0 110-24.5t94.5-48 92.5-65.5q170-123 498-345 57-39 1e2-87zm0-294q0 79-49 151t-122 123q-376 261-468 325-10 7-42.5 30.5t-54 38-52 32.5-57.5 27-50 9h-2q-23 0-50-9t-57.5-27-52-32.5-54-38T639 1015q-91-64-262-182.5T172 690q-62-42-117-115.5T0 438q0-78 41.5-130T160 256h1472q65 0 112.5 47t47.5 113z"/></svg></div></div></div></header><div class=article-hero-image id=ArticleImage__Hero><img src=/post/jira-dc-geocaching-without-public-cdn/images/cover.jpg></div></div></section><aside id=progressBar class=aside-container><div class=aside-align><div><div class=overlap-container></div></div></div><div class=progress-container tabindex={-1}><div class=track-line aria-hidden=true><div id=progressIndicator class=progress-line></div></div></div></aside><article id=articleContent class=post-content style=position:relative><p>Atlassian recently introduced Content Delivery Networks (CDN) support to their products, namely Jira from version 8.3 onwards. This support includes common CDNs like AWS CloudFront, Cloudflare, Akamai, and others<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. However, there is no clear documentation on how to use the feature using self-hosted cache servers instead of a publicly available CDN. In this article, we go through the procedure of implementing Jira cache servers in other geographic locations and enabling them in Jira using the CDN feature. We were able to configure an on-premises approach using a couple of Apache cache servers in remote locations (Germany and USA) connected to a Jira instance located in Japan. In the end, we concluded there was an improvement of about 69% to the European region and 52% to the Americas region using our approach.</p><h1 id=introduction>INTRODUCTION</h1><p>We at Rakuten manage a Jira instance that consists of thousands of users, mainly located in Japan, however many users are in other remote offices around the world, namely in the European region and North America. These users, while still needing to use the same instance were limited to worse access times than their colleagues in Japan. Until recently Jira did not support multiple geographies distribution, Atlassian introduced support for Content Delivery Networks (CDN) to their products, specifically Jira from version 8.3 onwards. This support includes common CDNs like AWS CloudFront, Cloudflare, Akamai, and others<sup id=fnref1:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. This solution would allow us to cache data closer to users, therefore, improving their user experience by reducing the access times, but since we have some concerns about using a public CDN we ideally wanted to implement our caching solution, which was a challenge since it’s not clearly supported by Atlassian and there are not many documented approaches available. In this article, we will explain how we could achieve said implementation and present our results.</p><h1 id=background>BACKGROUND</h1><p>Rakuten’s Jira instance (R-Jira) consists of a series of application servers running the Jira product itself, one database server that is connected to those, which are in their turn connected to a couple of redundant reverse proxy servers (see Figure 1). User requests arrive at the reverse proxy and are then forwarded to the application servers.</p><table><thead><tr><th style=text-align:center><img src=images/Picture1.png alt="FIGURE 1 - RAKUTEN JIRA INSTANCE (R-JIRA)" title="FIGURE 1 - RAKUTEN JIRA INSTANCE (R-JIRA)"></th></tr></thead><tbody><tr><td style=text-align:center>FIGURE 1 - RAKUTEN JIRA INSTANCE (R-JIRA)</td></tr></tbody></table><p>As for Jira’s CDN support, when enabled, static assets (such as JavaScript, CSS, and fonts) are cached on edge servers provided by a CDN vendor that are geographically closer to the user<sup id=fnref2:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. Jira does this by redirecting traffic to the cached assets to another URL, which is configured manually in the UI (example: jira-cache.example.com).</p><table><thead><tr><th style=text-align:center><img src=images/Picture2.png alt="FIGURE 2 - JIRA&amp;rsquo;S CDN DIAGRAM" title="FIGURE 2 - JIRA'S CDN DIAGRAM"></th></tr></thead><tbody><tr><td style=text-align:center>FIGURE 2 - JIRA&rsquo;S CDN DIAGRAM <a href=https://confluence.atlassian.com/adminjiraserver/use-a-cdn-with-atlassian-data-center-applications-974378840.html target=_blank rel="external noopener noreferrer nofollow">Atlassian, 2019</a></td></tr></tbody></table><p>In order to enable support, there are a few requirements<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>:</p><ul><li>HTTP2 needs to be enabled in the reverse proxy from Figure 1, as it is required by Jira to use CDN.</li><li>Edge servers need to be installed with a web server like Apache to work as a caching server.</li><li>Global Server Load Balancing (GSLB) needs to be set up on the network to route traffic based on geographic location.</li><li>Domain Name Server (DNS) entries need to be added for the cache servers (example: jira-cache.example.com).</li><li>All the cache servers need to use the same name as above, GSLB will be responsible to direct the traffic to each one according to the user’s location.</li></ul><h1 id=solution>SOLUTION</h1><p>To implement the previously described requirements we did the following:</p><ul><li>Jira’s certificate was updated to include the CDN URL.</li><li>Ubuntu servers running Apache for caching the data<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>.<ul><li>The modules mod_cache_disk and mod_http2 needed to be enabled in Apache.</li><li>A reverse proxy to the main Jira URL needs to be configured as well, otherwise not yet cached assets cannot be accessed while using the cache server. However, this was done only for [Jira URL]/s since only that path is used by the CDN feature. Traffic to other paths was blocked for security.</li><li>HTTP2 was enabled.</li><li>Cache was enabled and a cached data path configured.</li></ul></li><li>Certificates were added, these must be the same certificate as in the main Jira instance.</li><li>GSLB was configured in the network using F5, this configuration will send the traffic to the server IP address closest to the user.</li><li>HTTP2 was enabled in the reverse proxies’ Haproxy configuration.</li><li>DNS entries were added for the CDN URL (which is a URL for our Apache servers).</li><li>Jira was configured in the UI to use the URL (see Figure 3).</li></ul><table><thead><tr><th style=text-align:center><img src=images/Picture3.png alt="FIGURE 3 - JIRA&amp;rsquo;S CDN CONFIGURATION" title="FIGURE 3 - JIRA'S CDN CONFIGURATION"></th></tr></thead><tbody><tr><td style=text-align:center>FIGURE 3 - JIRA&rsquo;S CDN CONFIGURATION</td></tr></tbody></table><p>However, we faced a challenge: since we only added a couple of servers, one in Germany and another one in the USA, we needed to make sure that when Jira redirected the traffic to the CDN URL (example: jira-cache.example.com), users located in Japan were not directed to the cache servers located in the other countries. To fix this we added the Japanese reverse proxy IP address to the GSLB configuration, this way the example URL jira-cache.example.com will also send the requests to Japan if the users are closer to that location, completely bypassing the cache servers we configured in that scenario.</p><table><thead><tr><th style=text-align:center><img src=images/Picture4.png alt="FIGURE 4 - GSLB TRAFFIC DIAGRAM" title="FIGURE 4 - GSLB TRAFFIC DIAGRAM"></th></tr></thead><tbody><tr><td style=text-align:center>FIGURE 4 - GSLB TRAFFIC DIAGRAM</td></tr></tbody></table><h1 id=results>RESULTS</h1><p>Figure 5 shows how the traffic appears in the browser’s web development tools, as displayed both domains for the main Jira URL (jira.example.com) and the CDN URL (jira-cache.example.com) can be seen as requests are made, static assets are requested to the CDN URL instead of the main Jira URL.</p><table><thead><tr><th style=text-align:center><img src=images/Picture5.png alt="FIGURE 5 - NETWORK TRAFFIC WHEN USING CDN AS SEEN IN THE BROWSER" title="FIGURE 5 - NETWORK TRAFFIC WHEN USING CDN AS SEEN IN THE BROWSER"></th></tr></thead><tbody><tr><td style=text-align:center>FIGURE 5 - NETWORK TRAFFIC WHEN USING CDN AS SEEN IN THE BROWSER</td></tr></tbody></table><p>In Figure 6 a diagram representing how traffic is directed after enabling the CDN in Jira can be seen, users located in the US are directed to the US cache server to access the cached data (static assets), while other requests still go directly to Japan. The same goes for users in Europe.</p><table><thead><tr><th style=text-align:center><img src=images/Picture6.png alt="FIGURE 6 - RAKUTEN JIRA INSTANCE WITH CACHE SERVERS ENABLED" title="FIGURE 6 - RAKUTEN JIRA INSTANCE WITH CACHE SERVERS ENABLED"></th></tr></thead><tbody><tr><td style=text-align:center>FIGURE 6 - RAKUTEN JIRA INSTANCE WITH CACHE SERVERS ENABLED</td></tr></tbody></table><p>Finally, in Figure 7 there is a representation of how the access times improved based on multiple access tests from remote locations. We measured an improvement of 69% from Europe and 52% from the US with our test data.</p><table><thead><tr><th style=text-align:center><img src=images/Picture7.png alt="FIGURE 7 - AVERAGE CDN IMPROVEMENT RESULTS BASED ON MULTIPLE ACCESS TESTS" title="FIGURE 7 - AVERAGE CDN IMPROVEMENT RESULTS BASED ON MULTIPLE ACCESS TESTS"></th></tr></thead><tbody><tr><td style=text-align:center>FIGURE 7 - AVERAGE CDN IMPROVEMENT RESULTS BASED ON MULTIPLE ACCESS TESTS (Based on <a href=https://commons.wikimedia.org/wiki/File:BlankMap-World.svg target=_blank rel="external noopener noreferrer nofollow">https://commons.wikimedia.org/wiki/File:BlankMap-World.svg</a>)</td></tr></tbody></table><h1 id=conclusion>CONCLUSION</h1><p>Our test result data gives us confidence there is a real improvement in the user experience for our colleagues outside Japan. The application now feels “snappier” and while still needing to scale according to the number of users, we only added a couple of low spec’d and relatively low-cost cache servers. The investment cost was worth it for the performance improvement. As a bonus, we do not need to subscribe to an external CDN product to make this work to our needs.
To add to that, new cache servers can be set up easily on new locations if necessary: we only need to add a new server, a GSLB update, and a certificate update (only if the certificate is not valid for that new one).</p><h1 id=final-thoughts>FINAL THOUGHTS</h1><p>Since finishing the development and testing of this approach presented here, we have enabled both the US and EU cache servers for our Jira production, which is now usable by all our Jira users. Since the results were good, we would like to continue working on this feature for other applications as well. We are now planning the same for Confluence and are sure to face new challenges we look forward to overcoming and hopefully come with results as good as the ones for Jira.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Atlassian. (2019, July 11). Use a CDN with Atlassian Data Center applications. Retrieved from Administering Jira applications Support: <a href=https://confluence.atlassian.com/adminjiraserver/use-a-cdn-with-atlassian-data-center-applications-974378840.html target=_blank rel="external noopener noreferrer nofollow">https://confluence.atlassian.com/adminjiraserver/use-a-cdn-with-atlassian-data-center-applications-974378840.html</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref2:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Atlassian. (2019, July 11). Configure your CDN for Jira Data Center. Retrieved from Administering Jira applications Support: <a href=https://confluence.atlassian.com/adminjiraserver/configure-your-cdn-for-jira-data-center-974378841.html target=_blank rel="external noopener noreferrer nofollow">https://confluence.atlassian.com/adminjiraserver/configure-your-cdn-for-jira-data-center-974378841.html</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>Atlassian. (2021, March 29). How to configure Apache for caching and HTTP/2. Retrieved from Atlassian Support: <a href=https://confluence.atlassian.com/kb/how-to-configure-apache-for-caching-and-http-2-972332210.html target=_blank rel="external noopener noreferrer nofollow">https://confluence.atlassian.com/kb/how-to-configure-apache-for-caching-and-http-2-972332210.html</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><section id=articleNext class="section nartrow"><h3 class=footer-next-heading>More articles from Rakuten Engineering Blog</h3><div class=footer-spacer></div><div class=next-articles-grid numberofarticles={numberOfArticles}><div class=post-row><a href=/post/fewer-parameters-means-fewer-bugs/ class=article-link id=article-link-bigger><div><div class=image-container><img src=/images/hero-5.jpg class=article-image></div><div><h2 class=article-title>Fewer parameters means fewer bugs</h2><p class=article-excerpt>Tips for coding efficiently and reducing bugs</p><div class=article-metadata>October 20, 2021 · 11 min read</div></div></div></a><a href=/post/elm-at-rakuten/ class=article-link><div><div class=image-container><img src=/post/elm-at-rakuten/images/elm-at-rakuten.png class=article-image></div><div><h2 class=article-title>Elm at Rakuten</h2><p class=article-excerpt>Our story of adopting the Elm language in Rakuten. The lessons we learned, and our likes and dislikes.</p><div class=article-metadata>August 1, 2021 · 41 min read</div></div></div></a></div></div></section></section><script src=/js/progressBar.js></script><div class=footer-gradient></div><div class="section narrow"><div class=footer-hr></div><div class=footer-container><div class=footer-text>&copy; 2022 Rakuten Group, Inc.<br><br><div class=license-icons><a rel=license href=https://creativecommons.org/licenses/by/4.0/ title="Creative Commons Attribution 4.0 International license"><i class=cc-icon-cc></i>
<i class=cc-icon-cc-by></i></a></div>Except where otherwise noted, content on this site is licensed under a <a rel="external noopener" href=https://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0 International license</a>.</div><div class=footer-text><a href=https://github.com/rakutentech><svg class="social-icon-image" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path fillrule="evenodd" cliprule="evenodd" d="M7 0C3.1325.0.0 3.21173.0 7.17706.0 10.3529 2.00375 13.0353 4.78625 13.9863 5.13625 14.0491 5.2675 13.8338 5.2675 13.6454 5.2675 13.4749 5.25875 12.9097 5.25875 12.3087 3.5 12.6406 3.045 11.8691 2.905 11.4653 2.82625 11.259 2.485 10.622 2.1875 10.4516 1.9425 10.317 1.5925 9.98508 2.17875 9.97611 2.73 9.96714 3.12375 10.4964 3.255 10.7118c.63 1.0855 1.63625.7805 2.03875.5921C5.355 10.8374 5.53875 10.5234 5.74 10.3439 4.1825 10.1645 2.555 9.54549 2.555 6.80026c0-.7805.27125-1.42644.7175-1.92883C3.2025 4.692 2.9575 3.95635 3.3425 2.96951c0 0 .58625-.1884 1.925.73565.56-.16149 1.155-.24223 1.75-.24223s1.19.08074 1.75.24223c1.3388-.93302 1.925-.73565 1.925-.73565C11.0775 3.95635 10.8325 4.692 10.7625 4.87143 11.2087 5.37382 11.48 6.01079 11.48 6.80026c0 2.7542-1.63625 3.36424-3.19375 3.54364C8.54 10.5682 8.75875 10.9988 8.75875 11.6717 8.75875 12.6316 8.75 13.4032 8.75 13.6454 8.75 13.8338 8.88125 14.0581 9.23125 13.9863 11.9963 13.0353 14 10.3439 14 7.17706 14 3.21173 10.8675.0 7 0z" fill="#73737d"/></svg></a><a href=https://github.com/rakutentech>Rakuten Tech Github</a></div></div></div><script src=/js/extra.js></script></div><script src=/js/prism.js></script></body></html>